<!doctype html><html><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><title>Better Switch-Case for Java! - LALIT's TECH BLOG</title>
<link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../site.webmanifest><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#da532c"><meta name=theme-color content="#ffffff"><meta name=viewport content="width=device-width,initial-scale=1"><script async src="https://www.googletagmanager.com/gtag/js?id=G-DNE09NG226"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-DNE09NG226")</script><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3468549466738898" crossorigin=anonymous></script><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3468549466738898" crossorigin=anonymous></script><meta name=description content="Letâ€™s start with the question, what is wrong with the switch-case anyway? Hereâ€™s a simple example of a switch-case in Java:
Can you see the problem here? It is the unnecessary â€œceremonyâ€ of writing the â€œbreakâ€ statement on each case!
You can argue that we can just return after each case-block, while this is a brilliant idea but, then the ceremony would be of writing â€œreturnâ€ in each block ğŸ˜œ you can even miss that!"><meta property="og:image" content><meta property="og:title" content="Better Switch-Case for Java!"><meta property="og:description" content="Letâ€™s start with the question, what is wrong with the switch-case anyway? Hereâ€™s a simple example of a switch-case in Java:
Can you see the problem here? It is the unnecessary â€œceremonyâ€ of writing the â€œbreakâ€ statement on each case!
You can argue that we can just return after each case-block, while this is a brilliant idea but, then the ceremony would be of writing â€œreturnâ€ in each block ğŸ˜œ you can even miss that!"><meta property="og:type" content="article"><meta property="og:url" content="https://www.lprakashv.com/posts/2021-05-25_better-switchcase-for-java/"><meta property="og:image" content="https://www.lprakashv.com/posts/2021-05-25_better-switchcase-for-java/images/1.png"><meta property="og:image" content="https://www.lprakashv.com/posts/2021-05-25_better-switchcase-for-java/images/2.png"><meta property="og:image" content="https://www.lprakashv.com/posts/2021-05-25_better-switchcase-for-java/images/3.png"><meta property="og:image" content="https://www.lprakashv.com/posts/2021-05-25_better-switchcase-for-java/images/4.png"><meta property="og:image" content="https://www.lprakashv.com/posts/2021-05-25_better-switchcase-for-java/images/5.png"><meta property="og:image" content="https://www.lprakashv.com/posts/2021-05-25_better-switchcase-for-java/images/6.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2021-05-25T11:30:29+00:00"><meta property="article:modified_time" content="2022-08-13T01:14:58+05:30"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://www.lprakashv.com/posts/2021-05-25_better-switchcase-for-java/images/1.png"><meta name=twitter:title content="Better Switch-Case for Java!"><meta name=twitter:description content="Letâ€™s start with the question, what is wrong with the switch-case anyway? Hereâ€™s a simple example of a switch-case in Java:
Can you see the problem here? It is the unnecessary â€œceremonyâ€ of writing the â€œbreakâ€ statement on each case!
You can argue that we can just return after each case-block, while this is a brilliant idea but, then the ceremony would be of writing â€œreturnâ€ in each block ğŸ˜œ you can even miss that!"><script src=https://www.lprakashv.com/js/feather.min.js></script><link href=https://www.lprakashv.com/css/fonts.b685ac6f654695232de7b82a9143a46f9e049c8e3af3a21d9737b01f4be211d1.css rel=stylesheet><link rel=stylesheet type=text/css media=screen href=https://www.lprakashv.com/css/main.42a94afe1d883ff4fcef4d850a21c8e0c6903e7b33798d5ca18916cbd645a78a.css></head><body><div class=content><header><div class=main><div style=display:flex;flex-direction:row><img src=../../Lalit-new-logo.png style=border-color:#fff;border-radius:10px;width:150px><div style=margin:auto><a href=https://www.lprakashv.com/ style=font-size:2vh;font-weight:700>LALIT's TECH BLOG</a></div></div></div><nav><a href=../../>Home</a>
<a href=../../posts>All posts</a>
<a href=../../about>About</a>
<a href=../../tags>Tags</a></nav></header><main><article><div class=title><h1 class=title>Better Switch-Case for Java!</h1><div class=meta>Posted on May 25, 2021</div></div><section class=body><p><img src=../../posts/2021-05-25_better-switchcase-for-java/images/1.png#layoutTextWidth alt=image></p><p>Letâ€™s start with the question, what is wrong with the switch-case anyway? Hereâ€™s a simple example of a switch-case in Java:</p><p><img src=../../posts/2021-05-25_better-switchcase-for-java/images/2.png#layoutTextWidth alt=image></p><p>Can you see the problem here? It is the unnecessary â€œceremonyâ€ of writing the â€œbreakâ€ statement on each case!</p><p>You can argue that we can just return after each case-block, while this is a brilliant idea but, then the ceremony would be of writing â€œreturnâ€ in each block ğŸ˜œ you can even miss that!</p><p>In fact, the return statement at every case-block means that every block should <strong>always</strong> â€œreturnâ€ or â€œevaluateâ€ to something! Which is the most fundamental idea in Functional Programming, where <strong><em>every expression must return or evaluate something</em></strong> just like a mathematical â€œfunctionâ€.</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-text data-lang=text><span style=display:flex><span>value := **F(x)** &lt;--- always returns a value!
</span></span></code></pre></div><p>In, fact this switch-case with always returning case blocks is omnipresent in all the FP languages as <strong>â€œPattern Matchingâ€</strong>, here is a simple determistic example code in Clojure:</p><p><img src=../../posts/2021-05-25_better-switchcase-for-java/images/3.png#layoutTextWidth alt=image></p><p>Some languages like Scala, Haskell take this idea even further to allow partial match or even destructured matches on the input argument:</p><p><img src=../../posts/2021-05-25_better-switchcase-for-java/images/4.png#layoutTextWidth alt=image></p><p>Enough features of other languages now! Now letâ€™s come back to our hero here â€œ<strong>JAVA</strong>â€, can we do similar things in Java?</p><blockquote><p>Yes and No.</p></blockquote><p>The standard library doesnâ€™t have any similar feature but there are a few libraries supporting this, one among those is <a href=https://docs.vavr.io/#_pattern_matching><strong>Vavr</strong></a> check it out!</p><p>However, I am going to shamelessly endorse my own library for this <a href=https://github.com/lprakashv/patternmatcher4j>job: <strong>â€œpatternmatcher4jâ€</strong></a>. **** You can start by adding the dependency:</p><p><strong><em>Maven:</em></strong></p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#070>&lt;dependency&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#070>&lt;groupId&gt;</span>io.github.lprakashv<span style=color:#070>&lt;/groupId&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#070>&lt;artifactId&gt;</span>patternmatcher4j<span style=color:#070>&lt;/artifactId&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#070>&lt;version&gt;</span>0.2.0<span style=color:#070>&lt;/version&gt;</span>
</span></span><span style=display:flex><span><span style=color:#070>&lt;/dependency&gt;</span>`
</span></span></code></pre></div><p><strong><em>Gradle:</em></strong></p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-gradle data-lang=gradle><span style=display:flex><span>implementation <span style=background-color:#fff0f0>&#39;io.github.lprakashv:patternmatcher4j:0.2.0&#39;</span>
</span></span></code></pre></div><p>Here is our simple case-match with the enum:</p><p><img src=../../posts/2021-05-25_better-switchcase-for-java/images/5.png#layoutTextWidth alt=image></p><p>Now, letâ€™s see some advanced match-cases:</p><p><img src=../../posts/2021-05-25_better-switchcase-for-java/images/6.png#layoutTextWidth alt=image></p><p>Insâ€™nt this awesome? Short explanation of the library code-test above:</p><p><strong>PMatcher&lt;T, R>:</strong></p><p>This is like an actual switch-case block, we initialize it using a constructor taking an object to be matched. This is a parameterized class where T = input matched object type and R = return type of the block.</p><p><strong>Match Cases:</strong></p><p>We can create a match-case using:</p><ol><li><code>.matchValue(value)</code>â€Šâ€”â€Što match the matched-object with the passed value using Javaâ€™s <strong><em>equals()</em></strong> method,</li><li><code>.matchRef(ref)</code>â€Šâ€”â€Što matched the reference of the original matched-object with the passed ref.</li><li><code>.matchCase(..)</code>â€Šâ€”â€Šadvanced matching!</li></ol><p><strong>Advanced matchCase():</strong></p><p>We can match using 3 different types of cases:</p><ol><li>Predicate match: To match the matched-object using a predicate.â€Šâ€”â€Š<code>.matchCase(p -> methodReturningBoolean(p))</code></li><li>Class match: To match the class of the matched-objectâ€Šâ€”â€Š<code>.matchCase(SomeClass.class)</code></li><li>De-structured match: To match matched-objectâ€™s fields (which internally uses Reflection API). <em>You can even use the recursive match with the</em> <strong><em>MField</em></strong> <em>objects passed to the matchCase passing any of predicate, class, further de-structured matches</em>â€”â€Š<code>.matchCase(MField.with("field1", ...), MField.withValue("field2", field2Value), MField.with("field3", Field3.class))</code></li></ol><p><strong>Actions:</strong></p><p>Each of the matchCase, matchValue and matchRef produces an object of class â€œCaseActionAppenderâ€ which has 3 â€œactionâ€ methods which you can use to define action on the preceding match-case.</p><ol><li><code>.thenReturn(R returnValue)</code>â€Šâ€”â€Što return the value on the preceding match-case.</li><li><code>.thenSupply(Supplier&lt;R> supplier)</code>â€Šâ€”â€Što evaluate the return value lazily using a supplier.</li><li><code>.thenTransform(Function&lt;T,R> fn)</code>â€Šâ€”â€Što evaluate the return value by performing transformation operation on the matched-object.</li></ol><h2 id=fin>Fin</h2><p>Please use the library and provide your valuable feedback, you can even raise a PR and I will look into it. This was my very first maven-central deployment so any suggestion will be welcomed :)</p><p>Thanks for reading!</p></section><div class=post-tags><nav class="nav tags"><ul class=tags><li><a href=../../tags/java>java</a></li><li><a href=../../tags/java-streams>java streams</a></li><li><a href=../../tags/functional-programming>functional programming</a></li><li><a href=../../tags/fp>FP</a></li><li><a href=../../tags/pattern-matching>pattern matching</a></li><li><a href=../../tags/switch-case>switch case</a></li></ul></nav></div><script id=diffblog-plugin-script async src=https://diff.blog/static/js/diffblog_plugin_v1.js></script><script>document.getElementById("diffblog-plugin-script").addEventListener("load",function(){DiffBlog("hhv3f1602vgc1ljqid62utggmyom9g2ujt9tm6gw74msobue5n")})</script><div id=disqus_thread></div><script>(function(){var e=document,t=e.createElement("script");t.src="https://lprakashv-tech-blog.disqus.com/embed.js",t.setAttribute("data-timestamp",+new Date),(e.head||e.body).appendChild(t)})()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript></article></main><footer><div style=display:flex><a class=soc href=https://www.linkedin.com/in/lprakashv/ title=Linkedin><i data-feather=linkedin></i></a>
<a class=border></a><a class=soc href=https://github.com/lprakashv title=GitHub><i data-feather=github></i></a>
<a class=border></a><a class=soc href=https://twitter.com/lprakashv/ title=Twitter><i data-feather=twitter></i></a>
<a class=border></a><a class=soc href="https://stackoverflow.com/users/4066802/lprakashv?tab=profile" title=stackoverflow><i data-feather=stackoverflow></i></a>
<a class=border></a></div><div class=footer-info>2024 Â© Lalit Prakash Vatsal |</div></footer><script>feather.replace()</script></div></body></html>