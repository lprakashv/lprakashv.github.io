<!DOCTYPE html>
<html><head>
	<meta charset="utf-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge"><title>Intro to Reactive Spring - LPRAKASHV TECH BLOG</title><meta name="viewport" content="width=device-width, initial-scale=1">
  
<script async src="https://www.googletagmanager.com/gtag/js?id=G-EJ9HBFC442"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-EJ9HBFC442');
</script>

	<meta name="description" content="TODO — 1. flux and mono examples (initialisations, simple operations, chaining, error handling, when to subscribe), 2. functional endpoints example.
Spring 5 Spring 5 web stack comes in 2 different flavours, Spring MVC and Spring WebFlux. Spring MVC is your regular old Spring’s web framework while Spring WebFlux is the reactive counterpart for the Spring MVC.
Spring Webflux under the hood Spring WebFlux can be considered a redesign of Spring MVC without taking away its simplicity and modifying the API too much." />
	<meta property="og:image" content=""/>
	<meta property="og:title" content="Intro to Reactive Spring" />
<meta property="og:description" content="TODO — 1. flux and mono examples (initialisations, simple operations, chaining, error handling, when to subscribe), 2. functional endpoints example.
Spring 5 Spring 5 web stack comes in 2 different flavours, Spring MVC and Spring WebFlux. Spring MVC is your regular old Spring’s web framework while Spring WebFlux is the reactive counterpart for the Spring MVC.
Spring Webflux under the hood Spring WebFlux can be considered a redesign of Spring MVC without taking away its simplicity and modifying the API too much." />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://www.lprakashv.com/posts/draft__intro-to-reactive-spring/" /><meta property="og:image" content="http://www.lprakashv.com/posts/draft__intro-to-reactive-spring/images/1.png" /><meta property="og:image" content="http://www.lprakashv.com/posts/draft__intro-to-reactive-spring/images/2.png" /><meta property="og:image" content="http://www.lprakashv.com/posts/draft__intro-to-reactive-spring/images/3.png" /><meta property="og:image" content="http://www.lprakashv.com/posts/draft__intro-to-reactive-spring/images/4.gif" /><meta property="article:section" content="posts" />

<meta property="article:modified_time" content="2022-08-13T01:15:04+05:30" />

<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="http://www.lprakashv.com/posts/draft__intro-to-reactive-spring/images/1.png"/>

<meta name="twitter:title" content="Intro to Reactive Spring"/>
<meta name="twitter:description" content="TODO — 1. flux and mono examples (initialisations, simple operations, chaining, error handling, when to subscribe), 2. functional endpoints example.
Spring 5 Spring 5 web stack comes in 2 different flavours, Spring MVC and Spring WebFlux. Spring MVC is your regular old Spring’s web framework while Spring WebFlux is the reactive counterpart for the Spring MVC.
Spring Webflux under the hood Spring WebFlux can be considered a redesign of Spring MVC without taking away its simplicity and modifying the API too much."/>
<script src="http://www.lprakashv.com/js/feather.min.js"></script>
	
	
        <link href="http://www.lprakashv.com/css/fonts.b685ac6f654695232de7b82a9143a46f9e049c8e3af3a21d9737b01f4be211d1.css" rel="stylesheet">
	

	
	<link rel="stylesheet" type="text/css" media="screen" href="http://www.lprakashv.com/css/main.c854a9a2c53b1afadf31c3b562cfc34963b1caa5a9def32de484552e8dbdae30.css" />

	
</head>
<body>
      <div class="content-side">
        <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3468549466738898"
     crossorigin="anonymous"></script>

<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-3468549466738898"
     data-ad-slot="6861065745"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>

      </div>
        <div class="content"><header>
	<div class="main">
		<a href="http://www.lprakashv.com/">LPRAKASHV TECH BLOG</a>
	</div>
	<nav>
		
		<a href="/">Home</a>
		
		<a href="/posts">All posts</a>
		
		<a href="https://github.com/lprakashv/lprakashv">About</a>
		
		<a href="/tags">Tags</a>
		
		
	</nav>
</header>

<main>
	<article>
		<div class="title">
			<h1 class="title">Intro to Reactive Spring</h1>
			<div class="meta">Posted on Aug 13, 2022 <span class="draft-label">DRAFT</span> </div>
		</div>
		

		<section class="body">
      <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3468549466738898"
     crossorigin="anonymous"></script>

<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-3468549466738898"
     data-ad-slot="5126431802"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>

      
      
      
			<p>TODO — 1. flux and mono examples (initialisations, simple operations, chaining, error handling, when to subscribe), 2. functional endpoints example.</p>
<p><img src="/posts/draft__intro-to-reactive-spring/images/1.png#layoutTextWidth" alt="image"></p>
<h3 id="spring-5">Spring 5</h3>
<p>Spring 5 web stack comes in 2 different flavours, Spring MVC and Spring WebFlux. Spring MVC is your regular old Spring’s web framework while Spring WebFlux is the reactive counterpart for the Spring MVC.</p>
<h3 id="spring-webflux-under-the-hood">Spring Webflux under the hood</h3>
<p>Spring WebFlux can be considered a redesign of Spring MVC without taking away its simplicity and modifying the API too much. The following are the key differences with Spring MVC are:</p>
<ol>
<li><strong><em>Reactive streams:</em></strong> Spring Webflux provides complete back-pressure support across all the libraries by utilizing reactive streams implementations provided by “<a href="https://projectreactor.io/">Project Reactor</a>”.</li>
<li><strong><em>Asynchronous and Non blocking API:</em></strong> Spring Webflux provides fully non-blocking APIs. For non-blocking HTTP requests and responses, Java Servlets API has to provide non-blocking support as well, which was included in version 3.1. Hence, Spring Weblux can run on any servlet container using Servlet API 3.1+.</li>
<li><strong><em>Concurrency:</em></strong> Based on event loop concurrency model which allows concurrent connections with fewer threads instead on thread per request in Spring MVC.</li>
</ol>
<h3 id="keeping-spring-spring">Keeping Spring, Spring!</h3>
<p>Let’s see an example in action with writing a plain controller with get API:</p>
<p><img src="/posts/draft__intro-to-reactive-spring/images/2.png#layoutTextWidth" alt="image"></p>
<p>Notice this looks almost same as a Spring MVC controller, the only difference is being the return type “Mono” and “Flux”. This similar experience is what makes the transition to the Spring Webflux really easy.</p>
<ul>
<li>Just like above all the other Spring’s familiar annotations will also work in Webflux.</li>
<li>However, there is one differences in the above example, like a reactive repository which should return the reactive data types (Flux and Mono).</li>
</ul>
<h3 id="whats-different">What’s Different?</h3>
<p>Following image summarises the difference between stacks of <strong><em>Spring MVC</em></strong> and <strong><em>Spring WebFlux</em></strong>.</p>
<p><img src="/posts/draft__intro-to-reactive-spring/images/3.png#layoutTextWidth" alt="image">
Courtesy: docs.spring.io</p>
<p>There are some notable differences in which are key to understand before starting to build something using Weblux.</p>
<p><strong><em>Flux and Mono:</em></strong> Since, the reactive support is enabled using reactive streams implementation provided by the Project Reactor. It uses Reactor’s data types, Flux and Mono to represent typed sequences.</p>
<ul>
<li>Mono — data type to represent a nullable single value, or a stream sequence with 0 or 1 elements.</li>
<li>Flux — data type to represent a sequence of values.</li>
</ul>
<p>Both of the above provide a whole range of features and methods to work with, pretty standard transformation methods being the .flatMap() and .map().</p>
<p><strong>NOTE:</strong> There is one Gotcha though, Flux/Mono chained expressions only define a process and do not trigger it! We need to call a .subscribe() method start the process/stream.</p>
<p>However, in most of the cases, we do not need to call the .subscribe(), Spring itself does it on receiving requests. We just define multiple processes (Fluxes and Monos) in our services/daos and they eventually are triggered by a controller endpoint which internally manages the subscriptions for requests.</p>
<p><strong><em>Server Sent Events:</em></strong> Webflux provides support for the Server sent events with <code>org.springframework.codec.ServerSentEvent</code>. And using this is as easy as making a GET endpoint with return type <strong>Flux<!-- raw HTML omitted --></strong>.</p>
<p>Let’s build a demo endpoint for prime numbers as Server sent events with 1 second duration:</p>
<p>Testing it out:</p>
<p><img src="/posts/draft__intro-to-reactive-spring/images/4.gif#layoutTextWidth" alt="image"></p>
<p><strong><em>A Reactive WebClient:</em></strong> There is an out-of-the-box web client shipped with the Spring Webflux to make “reactive” http calls.</p>
<p><strong><em>Functional Endpoints:</em></strong> If we ever happen to move away or get bored of creating endpoints using annotations, we can use the functional endpoints. These are almost like the endpoints in many other web frameworks like express, http4s, akka-http, http4k etc.</p>
<h3 id="its-reactive-all-the-way">It’s Reactive all the way!</h3>
<p>Spring Webflux is completely reactive enabling us to write fully reactive applications. Every component of the framework uses its reactive counterpart APIs:</p>
<ul>
<li>Reactive Spring Security</li>
<li>Reactive Spring Data</li>
<li>Non-blocking server (e.g., Netty)</li>
</ul>
<h3 id="limitations">Limitations</h3>
<p>One major downside of being completely reactive is not-being able to use non-reactive/blocking libraries efficiently. Even though we can still use them by wrapping everything up inside the first-class citizens, Monos and Fluxes. Doing so, the application won’t remain truly reactive and there will be some blocking components in the application.</p>
<p>One major limitation from the standard and official support standpoint is the reactive JDBC support for some of the database drivers. The only database having reactive Spring Data access are:</p>
<ol>
<li>MongoDB</li>
<li>Cassandra</li>
<li>Couchbase</li>
<li>Redis</li>
</ol>
<p>We can’t help but notice that all of them are non-relational databases. However, the reactive Spring Data support is not a matter of database supporting reactive but of a reactive driver being available for the database.</p>
<p>Update: There exists an <strong><em>R2DBC</em></strong> (“Reactive Relational Data Base Connectivity”) library which provides reactive non-blocking API support for some of the mainstream databases like:</p>
<ul>
<li>MS SQL server</li>
<li>MySQL</li>
<li>PostgreSQL</li>
<li>H2</li>
</ul>
<h3 id="tldr">TL;DR</h3>
<p>Spring Framework being most popular and adopted frameworks in Java development community has also embraced the reactive phenomena. The APIs and usage remains fairly similar to Spring MVC framework with additional reactive semantics to ease the developer transition.</p>

      <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3468549466738898"
     crossorigin="anonymous"></script>

<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-3468549466738898"
     data-ad-slot="5126431802"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>

		</section>

		<div class="post-tags">
			
			
			
		</div>
	</article>
</main>
<footer>
  <div style="display:flex"><a class="soc" href="https://www.linkedin.com/in/lprakashv/" title="Linkedin"><i data-feather="linkedin"></i></a>
    <a class="border"></a><a class="soc" href="https://github.com/lprakashv" title="GitHub"><i data-feather="github"></i></a>
    <a class="border"></a><a class="soc" href="https://twitter.com/lprakashv/" title="Twitter"><i data-feather="twitter"></i></a>
    <a class="border"></a><a class="soc" href="https://stackoverflow.com/users/4066802/lprakashv?tab=profile" title="stackoverflow"><i data-feather="stackoverflow"></i></a>
    <a class="border"></a></div>
  <div class="footer-info">
    2022  © Lalit Prakash Vatsal |  
  </div>
</footer>


<script>
  feather.replace()
</script></div>
        <div class="content-side">
          <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3468549466738898"
     crossorigin="anonymous"></script>

<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-3468549466738898"
     data-ad-slot="6861065745"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>

        </div>
    </body>
</html>
